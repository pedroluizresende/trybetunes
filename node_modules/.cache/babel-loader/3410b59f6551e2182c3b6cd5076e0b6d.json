{"ast":null,"code":"import _defineProperty from\"/home/pedroresende/projetos/trybe/frontend/sd-026-b-project-trybetunes/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _regeneratorRuntime from\"/home/pedroresende/projetos/trybe/frontend/sd-026-b-project-trybetunes/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/pedroresende/projetos/trybe/frontend/sd-026-b-project-trybetunes/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/home/pedroresende/projetos/trybe/frontend/sd-026-b-project-trybetunes/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/pedroresende/projetos/trybe/frontend/sd-026-b-project-trybetunes/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/pedroresende/projetos/trybe/frontend/sd-026-b-project-trybetunes/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/pedroresende/projetos/trybe/frontend/sd-026-b-project-trybetunes/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from'react';import{Redirect}from'react-router-dom';import Header from'../components/Header';import{getUser,updateUser}from'../services/userAPI';import Loading from'./Loading';import styles from'./ProfileEdit.module.css';import emptyUserPhoto from'../images/emptyUserPhoto.webp';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ProfileEdit=/*#__PURE__*/function(_Component){_inherits(ProfileEdit,_Component);var _super=_createSuper(ProfileEdit);function ProfileEdit(){var _this;_classCallCheck(this,ProfileEdit);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={userName:'',userEmail:'',userImage:'',userDescription:'',requestIsDone:true,isDisableButton:true,isSalved:false};_this.fetchUser=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var user;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({requestIsDone:false});_context.next=3;return getUser();case 3:user=_context.sent;_this.setState({userName:user.name,userEmail:user.email,userImage:user.image,userDescription:user.description,requestIsDone:true},function(){_this.validateButton();});case 5:case\"end\":return _context.stop();}}},_callee);}));_this.validateEmail=function(email){var re=/\\S+@\\S+\\.\\S+/;return re.test(email);};_this.validateButton=function(){var _this$state=_this.state,userEmail=_this$state.userEmail,userName=_this$state.userName,userDescription=_this$state.userDescription,userImage=_this$state.userImage;var isValidEmail=_this.validateEmail(userEmail);var isValid=userName.length>0&&userEmail.length>0&&userDescription.length>0&&userImage.length>0;if(isValid&&isValidEmail){_this.setState({isDisableButton:false});}};_this.salverUser=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var _this$state2,userName,userEmail,userImage,userDescription,userInfo;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this$state2=_this.state,userName=_this$state2.userName,userEmail=_this$state2.userEmail,userImage=_this$state2.userImage,userDescription=_this$state2.userDescription;userInfo={name:userName,email:userEmail,image:userImage,description:userDescription};_this.setState({requestIsDone:false});_context2.next=5;return updateUser(userInfo);case 5:_this.setState({isSalved:true,requestIsDone:true});case 6:case\"end\":return _context2.stop();}}},_callee2);}));_this.handleChange=function(_ref3){var target=_ref3.target;console.log(target.value);var name=target.name,value=target.value;_this.setState(_defineProperty({},name,value),function(){_this.validateButton();});};return _this;}_createClass(ProfileEdit,[{key:\"componentDidMount\",value:function componentDidMount(){this.fetchUser();}},{key:\"render\",value:function render(){var _this$state3=this.state,userName=_this$state3.userName,userEmail=_this$state3.userEmail,userImage=_this$state3.userImage,userDescription=_this$state3.userDescription,requestIsDone=_this$state3.requestIsDone,isDisableButton=_this$state3.isDisableButton,isSalved=_this$state3.isSalved;var editForm=/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.imageSection,children:[userImage===''?/*#__PURE__*/_jsx(\"img\",{className:styles.userImage,src:emptyUserPhoto,alt:\"Foto de Perfil\"}):/*#__PURE__*/_jsx(\"img\",{className:styles.userImage,src:userImage,alt:\"Foto de Perfil\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"userImage\",children:/*#__PURE__*/_jsx(\"input\",{className:styles.imageInput,type:\"text\",name:\"userImage\",placeholder:\"Insira um link\",id:\"username\",\"data-testid\":\"edit-input-image\",value:userImage,alt:\"Foto de Perfil\",onChange:this.handleChange})})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.textFields,children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"userName\",children:[\"Nome:\",/*#__PURE__*/_jsx(\"span\",{children:\"Fique \\xE0 vontade para usar seu nome social\"}),/*#__PURE__*/_jsx(\"input\",{name:\"userName\",id:\"userName\",type:\"name\",\"data-testid\":\"edit-input-name\",value:userName,onChange:this.handleChange,placeholder:\"Nome\"})]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"userEmail\",children:[\"Email:\",/*#__PURE__*/_jsx(\"span\",{children:\"Escolha um e-mail que consulte diariamente\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"userEmail\",id:\"userEmail\",\"data-testid\":\"edit-input-email\",value:userEmail,onChange:this.handleChange,placeholder:\"Email\"})]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"userDescription\",children:[\"Descri\\xE7\\xE3o:\",/*#__PURE__*/_jsx(\"textarea\",{name:\"userDescription\",id:\"userDescription\",\"data-testid\":\"edit-input-description\",value:userDescription,onChange:this.handleChange,placeholder:\"Sobre mim\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",\"data-testid\":\"edit-button-save\",disabled:isDisableButton,onClick:this.salverUser,children:\"Salvar\"})]})]});return/*#__PURE__*/_jsxs(\"main\",{\"data-testid\":\"page-profile-edit\",className:styles.container,children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"section\",{className:styles.profileEdit,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.banner}),/*#__PURE__*/_jsxs(\"section\",{className:styles.editSection,children:[!requestIsDone?/*#__PURE__*/_jsx(Loading,{header:false,textColor:\"rgba(192, 195, 201, 1)\"}):editForm,isSalved&&/*#__PURE__*/_jsx(Redirect,{to:\"/profile\"})]})]})]});}}]);return ProfileEdit;}(Component);export default ProfileEdit;","map":{"version":3,"names":["React","Component","Redirect","Header","getUser","updateUser","Loading","styles","emptyUserPhoto","ProfileEdit","state","userName","userEmail","userImage","userDescription","requestIsDone","isDisableButton","isSalved","fetchUser","setState","user","name","email","image","description","validateButton","validateEmail","re","test","isValidEmail","isValid","length","salverUser","userInfo","handleChange","target","console","log","value","editForm","imageSection","imageInput","textFields","container","profileEdit","banner","editSection"],"sources":["/home/pedroresende/projetos/trybe/frontend/sd-026-b-project-trybetunes/src/pages/ProfileEdit.jsx"],"sourcesContent":["import React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport Header from '../components/Header';\nimport { getUser, updateUser } from '../services/userAPI';\nimport Loading from './Loading';\nimport styles from './ProfileEdit.module.css';\nimport emptyUserPhoto from '../images/emptyUserPhoto.webp';\n\nclass ProfileEdit extends Component {\n  state = {\n    userName: '',\n    userEmail: '',\n    userImage: '',\n    userDescription: '',\n    requestIsDone: true,\n    isDisableButton: true,\n    isSalved: false,\n  };\n\n  componentDidMount() {\n    this.fetchUser();\n  }\n\n  fetchUser = async () => {\n    this.setState({\n      requestIsDone: false,\n    });\n    const user = await getUser();\n    this.setState({\n      userName: user.name,\n      userEmail: user.email,\n      userImage: user.image,\n      userDescription: user.description,\n      requestIsDone: true,\n    }, () => {\n      this.validateButton();\n    });\n  };\n\n  validateEmail = (email) => {\n    const re = /\\S+@\\S+\\.\\S+/;\n    return re.test(email);\n  };\n\n  validateButton = () => {\n    const { userEmail, userName, userDescription, userImage } = this.state;\n    const isValidEmail = this.validateEmail(userEmail);\n    const isValid = userName.length > 0\n    && userEmail.length > 0\n    && userDescription.length > 0\n    && userImage.length > 0;\n    if (isValid && isValidEmail) {\n      this.setState({\n        isDisableButton: false,\n      });\n    }\n  };\n\n  salverUser = async () => {\n    const { userName, userEmail, userImage, userDescription } = this.state;\n\n    const userInfo = {\n      name: userName,\n      email: userEmail,\n      image: userImage,\n      description: userDescription,\n    };\n    this.setState({\n      requestIsDone: false,\n    });\n    await updateUser(userInfo);\n    this.setState({\n      isSalved: true,\n      requestIsDone: true,\n    });\n  };\n\n  handleChange = ({ target }) => {\n    console.log(target.value);\n    const { name, value } = target;\n    this.setState({\n      [name]: value,\n    }, () => {\n      this.validateButton();\n    });\n  };\n\n  render() {\n    const { userName, userEmail, userImage, userDescription, requestIsDone,\n      isDisableButton, isSalved,\n    } = this.state;\n    const editForm = (\n      <form>\n        <div className={ styles.imageSection }>\n          {\n            userImage === ''\n              ? (\n                <img\n                  className={ styles.userImage }\n                  src={ emptyUserPhoto }\n                  alt=\"Foto de Perfil\"\n                />\n              ) : (\n                <img\n                  className={ styles.userImage }\n                  src={ userImage }\n                  alt=\"Foto de Perfil\"\n                />\n              )\n          }\n          <label htmlFor=\"userImage\">\n            <input\n              className={ styles.imageInput }\n              type=\"text\"\n              name=\"userImage\"\n              placeholder=\"Insira um link\"\n              id=\"username\"\n              data-testid=\"edit-input-image\"\n              value={ userImage }\n              alt=\"Foto de Perfil\"\n              onChange={ this.handleChange }\n            />\n          </label>\n        </div>\n        <div className={ styles.textFields }>\n          <label htmlFor=\"userName\">\n            Nome:\n            <span>Fique à vontade para usar seu nome social</span>\n            <input\n              name=\"userName\"\n              id=\"userName\"\n              type=\"name\"\n              data-testid=\"edit-input-name\"\n              value={ userName }\n              onChange={ this.handleChange }\n              placeholder=\"Nome\"\n            />\n          </label>\n          <label htmlFor=\"userEmail\">\n            Email:\n            <span>Escolha um e-mail que consulte diariamente</span>\n            <input\n              type=\"email\"\n              name=\"userEmail\"\n              id=\"userEmail\"\n              data-testid=\"edit-input-email\"\n              value={ userEmail }\n              onChange={ this.handleChange }\n              placeholder=\"Email\"\n            />\n          </label>\n          <label htmlFor=\"userDescription\">\n            Descrição:\n            <textarea\n              name=\"userDescription\"\n              id=\"userDescription\"\n              data-testid=\"edit-input-description\"\n              value={ userDescription }\n              onChange={ this.handleChange }\n              placeholder=\"Sobre mim\"\n            />\n          </label>\n          <button\n            type=\"button\"\n            data-testid=\"edit-button-save\"\n            disabled={ isDisableButton }\n            onClick={ this.salverUser }\n          >\n            Salvar\n          </button>\n        </div>\n      </form>\n    );\n\n    return (\n      <main data-testid=\"page-profile-edit\" className={ styles.container }>\n        <Header />\n\n        <section className={ styles.profileEdit }>\n\n          <div className={ styles.banner } />\n\n          <section className={ styles.editSection }>\n\n            { !requestIsDone ? <Loading\n              header={ false }\n              textColor=\"rgba(192, 195, 201, 1)\"\n            /> : editForm }\n            { isSalved && <Redirect to=\"/profile\" />}\n          </section>\n\n        </section>\n      </main>\n    );\n  }\n}\n\nexport default ProfileEdit;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}